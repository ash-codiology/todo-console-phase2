# Data Model: Console Todo App

**Feature**: 001-console-todo-app  
**Date**: 2026-01-02  
**Phase**: 1 (Design & Detailed Specification)

## Entity: Task

### Definition

The Task entity represents a single todo item in the system. It serves as the core data structure with all attributes required for task management operations.

### Attributes

| Attribute | Type | Required | Constraints | Description |
|-----------|------|----------|-------------|-------------|
| `id` | `int` | Yes | Auto-assigned, unique, positive integer starting from 1 | Unique identifier for the task |
| `title` | `str` | Yes | Non-empty, max recommended 100 chars | Short description of the task |
| `description` | `str` | No | Can be empty string, max recommended 500 chars | Detailed information about the task |
| `status` | `bool` | Yes | Default: `False` | Completion state (`False` = incomplete, `True` = complete) |
| `created_at` | `datetime` | Yes | Auto-assigned on creation | Timestamp when task was created (local timezone) |

### Python Implementation

```python
from dataclasses import dataclass
from datetime import datetime

@dataclass
class Task:
    """
    Represents a todo task.
    
    Attributes:
        id: Unique integer identifier (auto-assigned)
        title: Short description of the task (required, non-empty)
        description: Detailed information (optional, can be empty)
        status: Completion state (False=incomplete, True=complete)
        created_at: Timestamp of task creation
    """
    id: int
    title: str
    description: str
    status: bool
    created_at: datetime
```

### Validation Rules

#### Title Validation
- **Rule**: Title MUST NOT be empty or whitespace-only
- **Enforcement Point**: TaskManager.add_task(), TaskManager.update_task()
- **Error Response**: Return error to ConsoleUI, display "Title cannot be empty"

```python
def _validate_title(self, title: str) -> bool:
    """Validate task title is non-empty."""
    return bool(title and title.strip())
```

#### Description Validation
- **Rule**: Description is optional, empty string allowed
- **Default**: Empty string `""` when not provided

#### Status Validation
- **Rule**: Must be boolean (`True` or `False`)
- **Type Safety**: Enforced by dataclass type hints

#### ID Uniqueness
- **Rule**: IDs MUST be unique across all tasks
- **Enforcement**: Auto-generated by TaskManager._generate_id()
- **Guarantee**: Monotonically increasing counter ensures uniqueness

### State Transitions

#### Task Lifecycle States

```
┌────────────┐
│   CREATED  │  (status = False, id assigned)
└─────┬──────┘
      │
      ├─────────► [UPDATED] (title/description changed, status unchanged)
      │
      ├─────────► [COMPLETED] (status changed to True via toggle)
      │                │
      │                ▼
      │           [INCOMPLETE] (status changed back to False via toggle)
      │
      └─────────► [DELETED] (removed from storage, ID never reused)
```

#### Valid Transitions

| From State | To State | Operation | Business Rules |
|------------|----------|-----------|----------------|
| CREATED (incomplete) | UPDATED | update_task() | Title and/or description changed, status unchanged |
| CREATED (incomplete) | COMPLETED | toggle_task_status() | status: False → True |
| COMPLETED | INCOMPLETE | toggle_task_status() | status: True → False (toggle is reversible) |
| Any state | DELETED | delete_task() | Task permanently removed, ID never reused |

### Relationships

**Task has NO relationships** in Phase I (in-memory, single-entity model).

Future phases may introduce:
- TaskList (groups of tasks)
- Tag (categorization)
- User (multi-user support)

### Indexing Strategy

#### Primary Key
- **Field**: `id`
- **Type**: Integer
- **Uniqueness**: Guaranteed by auto-increment generator

#### Storage Structure
- **In-Memory**: `Dict[int, Task]`
- **Lookup**: O(1) by task ID
- **List All**: O(n) iteration over dict values

### Business Rules

1. **ID Assignment**
   - IDs auto-assigned starting from 1
   - Incremented sequentially: 1, 2, 3, 4...
   - Never reused after deletion (counter never decrements)

2. **Title Requirement**
   - Cannot create or update task with empty title
   - Whitespace-only titles rejected

3. **Description Optional**
   - Empty description allowed and stored as `""`
   - No maximum length enforced (limited by system memory)

4. **Status Toggle**
   - Reversible operation (can toggle back and forth unlimited times)
   - No side effects (title/description/timestamps unchanged)

5. **Creation Timestamp**
   - Immutable after creation
   - Uses local system time (no timezone conversion)

6. **Update Behavior**
   - Only title and description can be updated
   - ID, status, and created_at remain unchanged during update operation

### Examples

#### Create Task

```python
from datetime import datetime
from todo_app.models import Task

task = Task(
    id=1,
    title="Buy groceries",
    description="Milk, eggs, bread",
    status=False,
    created_at=datetime.now()
)
```

#### Toggle Status

```python
# Make complete
task.status = True  # [ ] → [x]

# Revert to incomplete
task.status = False  # [x] → [ ]
```

#### Update Title/Description

```python
task.title = "Buy groceries and snacks"
task.description = "Milk, eggs, bread, chips"
# id, status, created_at remain unchanged
```

### Edge Cases

| Scenario | Behavior | Rationale |
|----------|----------|-----------|
| Empty description | Allowed, stored as `""` | Description is optional field |
| Very long title (>100 chars) | Stored fully, truncated in table display | No hard limit, UI handles display |
| Very long description (>500 chars) | Stored fully, truncated in table display | No hard limit, UI handles display |
| ID collision | Impossible | Auto-increment guarantees uniqueness |
| Negative or zero ID | Never generated | Counter starts at 1, only increments |
| Status not boolean | Prevented by type hints | Dataclass enforces type |
| Task deleted then ID reused | Never occurs | Counter never decrements |

### Future Considerations (Phase II+)

- **Persistence**: Serialize Task to JSON for file storage
- **Timestamps**: Add `updated_at` timestamp for change tracking
- **Sorting**: Add `priority` field for task ordering
- **Tags**: Add `tags: List[str]` for categorization
- **Due Dates**: Add `due_date: Optional[datetime]` for deadlines

Phase I intentionally keeps model minimal to maintain simplicity (Constitution Principle V).
